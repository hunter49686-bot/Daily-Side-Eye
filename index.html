<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>The Daily Side-Eye</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
body{font-family:Arial,Helvetica,sans-serif;margin:0;background:#fff;color:#111}
.wrap{max-width:1100px;margin:0 auto;padding:18px}
h1{font-size:42px;margin:0}
.tagline{color:#444;margin-top:6px}
.columns{display:grid;grid-template-columns:1fr 1fr 1fr;gap:28px}
@media(max-width:900px){.columns{grid-template-columns:1fr}}
.section-title{font-weight:900;font-size:22px;letter-spacing:1px;margin:16px 0 6px}
.rule{height:2px;background:#e5e5e5;margin-bottom:8px}
.item{margin-bottom:16px}
a.headline{font-weight:800;font-size:22px;color:#111;text-decoration:none}
a.feature{color:#b00000;font-size:30px}
.source{color:#666}
.sub{font-size:16px;margin-top:4px}
.badge{border:1px solid #bbb;border-radius:999px;padding:2px 8px;font-size:12px}
.ages{border:1px solid #c8a400;background:#fff7cc;border-radius:999px;padding:2px 8px;font-size:12px}
.meter{font-size:13px;color:#444;margin-left:6px}
.footer{border-top:2px solid #e5e5e5;margin-top:24px;padding-top:12px}
</style>
</head>
<body>
<div class="wrap">
<h1 id="title"></h1>
<div id="tagline" class="tagline"></div>
<p id="updated"></p>

<div id="cols" class="columns"></div>

<div class="footer">
<h2>THE WEEK IN HINDSIGHT</h2>
<ul id="week"></ul>
</div>
</div>

<script>
function meterDots(n){
  n=Math.max(1,Math.min(5,n||1));
  let s="";
  for(let i=1;i<=5;i++) s+=i<=n?"●":"○";
  return s;
}

fetch("headlines.json?cb="+Date.now())
.then(r=>r.json())
.then(d=>{
  title.textContent=d.site.name;
  tagline.textContent=d.site.tagline;
  updated.textContent="Last updated: "+new Date(d.generated_utc).toLocaleString();

  cols.innerHTML="";
  d.columns.forEach(col=>{
    const c=document.createElement("div");
    col.sections.forEach(sec=>{
      const s=document.createElement("div");
      s.innerHTML=`<div class="section-title">${sec.name.toUpperCase()}</div><div class="rule"></div>`;
      sec.items.forEach(it=>{
        const div=document.createElement("div");
        div.className="item";
        div.innerHTML=`
          ${it.ages_poorly?'<span class="ages">IF THIS AGES POORLY</span>':''}
          ${it.badge?'<span class="badge">'+it.badge+'</span>':''}
          <a class="headline ${it.feature?'feature':''}" href="${it.url}" target="_blank">${it.title}</a>
          <span class="source"> (${it.source})</span>
          <span class="meter"><b>SIDE-EYE</b> ${meterDots(it.meter)}</span>
          <div class="sub">${it.snark}</div>
        `;
        s.appendChild(div);
      });
      c.appendChild(s);
    });
    cols.appendChild(c);
  });

  week.innerHTML="";
  (d.week_in_hindsight||[]).forEach(l=>{
    const li=document.createElement("li");li.textContent=l;week.appendChild(li);
  });
});
</script>
</body>
</html>